################################################################################
# Autogenerated by build_tools/bazel_to_cmake/bazel_to_cmake.py from           #
# ../CompilerGym/compiler_gym/envs/llvm/service/BUILD                          #
#                                                                              #
# Use cmake_cmake_extra_content from iree/build_defs.oss.bzl to add arbitrary   #
# CMake-only content.                                                          #
#                                                                              #
# To disable autogeneration for this file entirely, delete this header.        #
################################################################################

cmake_add_all_subdirs()
# TODO(kyleherndon): fix all cmake_genrule dependencies in this file
source_group(
  "service",
  FILES
    "compiler_gym-llvm-service"
    if (DARWIN EQUAL TRUE)
      "@llvm//:darwin"
    else()
      "//compiler_gym/envs/llvm/service:libLLVMPolly"
    endif()
)
cmake_genrule(
  OUTS "compiler_gym-llvm-service-bin"
  COMMAND
    if (DARWIN EQUAL TRUE)
      "cp ${CMAKE_CURRENT_BINARY_DIR}/compiler_gym-llvm-service-prelinked $@"
    else()
      "cp ${CMAKE_CURRENT_BINARY_DIR}/compiler_gym-llvm-service-prelinked $@ && " +
      "chmod 666 $@ && " +
      "patchelf --set-rpath '$$ORIGIN' $@ && " +
      "chmod 555 $@"
    endif()
  DEPENDS
    ::compiler_gym-llvm-service-prelinked
)

cmake_genrule(
  OUTS "libLLVMPolly.so"
  COMMAND
    "cp $$(dirname $(location @clang-llvm-10.0.0-x86_64-linux-gnu-ubuntu-18.04//:clang))/../lib/LLVMPolly.so $@"
  DEPENDS
    "@clang-llvm-10.0.0-x86_64-linux-gnu-ubuntu-18.04//:all_files"
    "@clang-llvm-10.0.0-x86_64-linux-gnu-ubuntu-18.04//:clang"
)

cmake_cc_binary(
  NAME
    compiler_gym-llvm-service-prelinked
  SRCS
    "RunService.cc"
  DEPS
    ::LlvmSession
    compiler_gym::service::runtime::cc_runtime
)

cmake_cc_library(
  NAME
    ActionSpace
  HDRS
    "ActionSpace.h"
  SRCS
    "ActionSpace.cc"
  DEPS
    compiler_gym::service::proto::compiler_gym_service_cc
    compiler_gym::util::EnumUtil
    unconverted_name:@magic_enum
  PUBLIC
)

cmake_cc_library(
  NAME
    Benchmark
  HDRS
    "Benchmark.h"
  SRCS
    "Benchmark.cc"
  DEPS
    ::Cost
    compiler_gym::service::proto::compiler_gym_service_cc
    compiler_gym::util::GrpcStatusMacros
    compiler_gym::util::RunfilesPath
    compiler_gym::util::Subprocess
    unconverted_name:@boost//:filesystem
    unconverted_name:@com_github_grpc_grpc//:grpc++
    unconverted_name:@fmt
    unconverted_name:@glog
    unconverted_name:@llvm//10.0.0
  PUBLIC
)

cmake_cc_library(
  NAME
    BenchmarkFactory
  HDRS
    "BenchmarkFactory.h"
  SRCS
    "BenchmarkFactory.cc"
  DEPS
    ::Benchmark
    ::Cost
    compiler_gym::service::proto::compiler_gym_service_cc
    compiler_gym::util::GrpcStatusMacros
    compiler_gym::util::RunfilesPath
    compiler_gym::util::StrLenConstexpr
    unconverted_name:@boost//:filesystem
    unconverted_name:@com_github_grpc_grpc//:grpc++
    unconverted_name:@fmt
    unconverted_name:@glog
    unconverted_name:@llvm//10.0.0
  PUBLIC
)

cmake_cc_library(
  NAME
    Cost
  HDRS
    "Cost.h"
  SRCS
    "Cost.cc"
  DEPS
    compiler_gym::util::GrpcStatusMacros
    compiler_gym::util::RunfilesPath
    compiler_gym::util::Unreachable
    unconverted_name:@boost//:filesystem
    unconverted_name:@com_github_grpc_grpc//:grpc++
    unconverted_name:@fmt
    unconverted_name:@glog
    unconverted_name:@llvm//10.0.0
    unconverted_name:@magic_enum
    unconverted_name:@subprocess
  PUBLIC
)

cmake_cc_library(
  NAME
    LlvmSession
  COPTS
    "-DGOOGLE_PROTOBUF_NO_RTTI"
    "-fno-rtti"
  HDRS
    #"ActionHeaders.h"
    #"ActionSwitch.h"
    "LlvmSession.h"
  SRCS
    "LlvmSession.cc"
  DEPS
    ::ActionSpace
    ::Benchmark
    ::BenchmarkFactory
    ::Cost
    ::ObservationSpaces
    compiler_gym::service::CompilationSession
    compiler_gym::service::proto::compiler_gym_service_cc_grpc
    compiler_gym::third_party::autophase::InstCount
    compiler_gym::third_party::cpuinfo
    compiler_gym::util::EnumUtil
    compiler_gym::util::GrpcStatusMacros
    compiler_gym::util::RunfilesPath
    unconverted_name:@boost//:filesystem
    unconverted_name:@fmt
    unconverted_name:@glog
    unconverted_name:@llvm//10.0.0
    unconverted_name:@magic_enum
    unconverted_name:@nlohmann_json//:json
    unconverted_name:@programl//programl/graph/format:node_link_graph
    unconverted_name:@programl//programl/ir/llvm:llvm-10
    unconverted_name:@programl//programl/proto:programl_cc
    unconverted_name:@subprocess
    llvm_actions_genfiles
  PUBLIC
)

cmake_cc_library(
  NAME
    ObservationSpaces
  HDRS
    "ObservationSpaces.h"
  SRCS
    "ObservationSpaces.cc"
  DEPS
    ::Benchmark
    compiler_gym::service::proto::compiler_gym_service_cc
    compiler_gym::third_party::llvm::InstCount
    compiler_gym::util::EnumUtil
    unconverted_name:@glog
    unconverted_name:@magic_enum
    unconverted_name:@nlohmann_json//:json
    unconverted_name:@programl//programl/graph/format:node_link_graph
    unconverted_name:@programl//programl/proto:programl_cc
  PUBLIC
)

### BAZEL_TO_CMAKE_PRESERVES_ALL_CONTENT_BELOW_THIS_LINE ###
